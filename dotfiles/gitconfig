##
## Main settings
##

[alias]
    amend = commit --amend  # --reuse-message=HEAD

    c = commit

    diffc = diff --cached

    # Check diff against HEAD~n. Defaults to HEAD~
    diffh = !"diffh() { git diff HEAD~${1:-1}; }; diffh"

    # Prefer `push --force-with-lease` to `push --force` because it's safer
    forcepush = push --force-with-lease

    # Compact version of git log
    l = log --pretty=oneline --graph --abbrev-commit -n 20

    # Checkout pull request from a github remote
    # i.e.: pr upstream 1
    pr = !"pr() { git fetch $1 pull/$2/head:pr-$2; git checkout pr-$2; }; pr"

    # Interactive rebase starting from HEAD~n
    reb = !"reb() { git rebase -i HEAD~$1; }; reb"

    rebc = rebase --continue

    # Update author info: mainly used to change commit date to current time
    refresh = commit --amend --reset-author --no-edit

    s = status  # -s

    # Reset to HEAD~n. Defaults to HEAD~
    undo = !"undo() { git reset HEAD~${1:-1} -N; }; undo"

    # Aliases for handling files marked as `assume unchanged`
    hide = update-index --assume-unchanged
    unhide = update-index --no-assume-unchanged
    lsh = !git ls-files -v | grep "^[a-z]" # List files marked as `assume unchanged`


[commit]
    gpgsign = true


[core]
    autocrlf = input
    excludesfile = ~/.gitignore
    pager = diff-so-fancy | less --tabs=4 -RFX


[include]
    path = ~/.gitconfig.local


[init]
    defaultBranch = main


[pull]
    ff = only


[user]
    # `email` should be set in ./gitconfig.local
    # `name` should be set in ./gitconfig.local
    # `signingkey` should be set in ./gitconfig.local

    # Don't try to guess defaults for `user.name` and `user.email` to avoid leaking
    # sensitive data accidentally.
    useConfigOnly = true


[url "https://github.com/"]
    insteadOf = "github:"
    insteadOf = "gh:"

##
## Plugins
##

[diff-so-fancy]
    markEmptyLines = false
    stripLeadingSymbols = false
